---
title: MIDIマッピング
description: MIDIコントローラーを使ったTOXBOXの操作設定
sidebar:
  order: 4
---

このチュートリアルでは、MIDI コントローラーを TOXBOX に接続し、各機能を割り当てる方法を学びます。

## MIDI マッピングとは

MIDI マッピングは、MIDI コントローラー（ノブ、フェーダー、ボタンなど）の操作を TOXBOX の各機能に割り当てる機能です。これにより、マウスを使わずに直感的にビジュアルを操作できます。

## 対応デバイス

以下のような一般的な MIDI コントローラーに対応しています：

- **USB MIDI コントローラー**: AKAI、Novation、Korg など
- **DJ コントローラー**: Pioneer DJ、Native Instruments など（MIDI モード対応機種）
- **カスタムコントローラー**: Arduino + MIDI ライブラリなど

## MIDI コントローラーの接続

### 物理接続

1. MIDI コントローラーを PC に USB 接続
2. ドライバーがインストールされていることを確認（通常は自動）

### TouchDesigner での認識確認

1. TouchDesigner のメニューから `Dialogs` → `MIDI Device Mapper` を開く
2. 接続した MIDI デバイスがリストに表示されていることを確認

:::note
MIDI デバイスが認識されない場合は、TouchDesigner を再起動してみてください。
:::

## マッピングの基本手順

### 1. MIDI Learn モードを有効化

TOXBOX の MIDI Mapping 領域で **Learn** ボタンをクリックして、MIDI Learn モードを有効にします。

<!-- TODO: スクリーンショット - Learn ボタン -->

### 2. マッピング先を選択

マッピングしたい TOXBOX のコントロール（フェーダー、ボタンなど）をクリックします。選択されたコントロールがハイライト表示されます。

### 3. MIDI コントローラーを操作

MIDI コントローラーの対応するノブ、フェーダー、またはボタンを操作します。

### 4. マッピング完了

TOXBOX が MIDI 入力を検出すると、自動的にマッピングが設定されます。

### 5. Learn モードを終了

再度 **Learn** ボタンをクリックして、MIDI Learn モードを終了します。

## マッピング可能なコントロール

### Scene Panel

| コントロール | 推奨 MIDI | 説明 |
|-------------|----------|------|
| シーン選択 | ボタン/パッド | シーンの切り替え |
| レイヤーフェーダー | フェーダー/ノブ | 透明度調整 |

### Parameter Panel

| コントロール | 推奨 MIDI | 説明 |
|-------------|----------|------|
| パラメータスライダー | ノブ/フェーダー | 連続値の調整 |
| トグルボタン | ボタン | オン/オフ切り替え |

### Sequencer / Audio

| コントロール | 推奨 MIDI | 説明 |
|-------------|----------|------|
| BPM | ノブ | BPM の調整 |
| Tap Tempo | ボタン | タップテンポ入力 |
| Audio Gain | ノブ | 入力ゲイン調整 |

### Post Effects

| コントロール | 推奨 MIDI | 説明 |
|-------------|----------|------|
| エフェクト強度 | ノブ | エフェクトの適用量 |
| エフェクト On/Off | ボタン | エフェクトの切り替え |

## マッピングの管理

### マッピングの確認

現在のマッピング一覧は MIDI Mapping パネルで確認できます。

### マッピングの削除

1. 削除したいマッピングを選択
2. **Delete** または **Clear** ボタンをクリック

### マッピングの保存

TOXBOX プロジェクトを保存すると、MIDI マッピング設定も一緒に保存されます。

:::tip
異なる現場で異なるコントローラーを使う場合は、プロジェクトファイルをコピーして別々に設定を保存しておくと便利です。
:::

## 推奨レイアウト例

### 基本的な VJ セットアップ

```
┌─────────────────────────────────────────┐
│  [フェーダー x4]    │  [ノブ x8]          │
│  レイヤー 1-4      │  パラメータ調整      │
│                    │                      │
├─────────────────────────────────────────┤
│  [パッド x16]                            │
│  シーン選択（レイヤー1: 1-8, レイヤー2: 9-16）│
├─────────────────────────────────────────┤
│  [ボタン x8]                             │
│  ポストエフェクト On/Off                 │
└─────────────────────────────────────────┘
```

### ミニマルセットアップ

```
┌───────────────────┐
│  [ノブ x4]        │  レイヤーフェーダー
│  [ボタン x8]      │  シーン選択
└───────────────────┘
```

## トラブルシューティング

### MIDI が反応しない

1. MIDI デバイスが認識されているか確認（TouchDesigner の MIDI Device Mapper）
2. 正しいチャンネルで送信されているか確認
3. TOXBOX の MIDI Learn モードが有効になっているか確認

### 意図しないマッピングが発生する

1. Learn モードを終了する
2. 不要なマッピングを削除
3. 他の MIDI 機器からの干渉がないか確認

### フェーダー/ノブの反応がおかしい

- MIDI コントローラーの出力範囲（0-127）が正しく認識されているか確認
- コントローラーの設定で出力モードを確認（相対 vs 絶対）

## 次のステップ

- **[ポストエフェクト](../post-effects/)**: エフェクトを MIDI で操作する
- **[tox作成ガイド](../../creating-tox/)**: パラメータパネル対応の tox を作成し、MIDI で操作する
