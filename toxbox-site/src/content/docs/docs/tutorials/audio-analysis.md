---
title: オーディオ解析の使い方
description: 音楽に反応するビジュアルを作成するためのオーディオ解析機能
sidebar:
  order: 2
---

このチュートリアルでは、TOXBOX のオーディオ解析機能を使って、音楽に反応するビジュアルを作成する方法を学びます。

## オーディオ解析とは

オーディオ解析は、入力された音声信号を分析し、低音域・高音域の強さやピークを数値として出力する機能です。この数値を tox のパラメータに接続することで、音楽に反応するビジュアルを実現できます。

## Audio Device In の設定

### 入力デバイスの選択

1. Audio Analysis Panel を開く
2. **Audio Device In** のドロップダウンから入力デバイスを選択

### 入力ソースの例

| ソース | 説明 |
|--------|------|
| マイク | 会場の音を直接入力 |
| オーディオインターフェース | DJ ミキサー等からの入力 |
| ループバック | PC の再生音をそのまま入力 |

:::tip[ループバック設定]
Windows では「ステレオミキサー」、macOS では「BlackHole」などの仮想オーディオデバイスを使用すると、PC で再生中の音楽をそのまま入力できます。
:::

## 出力信号の種類

オーディオ解析は以下の 5 つの信号を出力します：

### トリガー信号

| 信号名 | 値 | 説明 |
|--------|-----|------|
| `Low_Trigger` | 0 or 1 | 低音域のトリガー（ビートに反応） |
| `High_Trigger` | 0 or 1 | 高音域のトリガー |

トリガー信号は、音量が閾値を超えた瞬間に `1` になり、すぐに `0` に戻ります。キックやスネアなどの瞬間的な反応に適しています。

### レベル信号

| 信号名 | 値 | 説明 |
|--------|-----|------|
| `Low` | 0〜1 | 低音域のレベル（連続値） |
| `High` | 0〜1 | 高音域のレベル（連続値） |
| `Peak` | 0〜1 | 全体のピークレベル |

レベル信号は音量に応じて連続的に変化します。スムーズな反応が必要な場合に適しています。

## パラメータへの接続（ChopReference）

オーディオ解析の出力を tox のパラメータに接続するには、**ChopReference** を使用します。

### 接続手順

1. Parameter Panel で接続したいパラメータを見つける
2. パラメータの横にある **ChopRef** ボタンをクリック
3. リストから接続したい信号を選択
   - `AudioAnalysis/Low_Trigger`
   - `AudioAnalysis/Low`
   - `AudioAnalysis/High_Trigger`
   - `AudioAnalysis/High`
   - `AudioAnalysis/Peak`

<!-- TODO: スクリーンショット - ChopReference設定 -->

### 接続の解除

ChopReference を解除するには、再度 **ChopRef** ボタンをクリックし、「None」を選択します。

## 実践例

### 例 1: キックに反応してスケールを変える

低音のトリガー（Low_Trigger）をスケールパラメータに接続すると、キックに合わせてビジュアルが拡大縮小します。

1. tox のスケールパラメータを見つける
2. ChopRef で `AudioAnalysis/Low_Trigger` を選択
3. → キックのタイミングでスケールが瞬間的に変化

### 例 2: 全体の音量で明るさを変える

Peak 信号を明るさパラメータに接続すると、音量に応じてビジュアルの明るさが変化します。

1. tox の明るさ/輝度パラメータを見つける
2. ChopRef で `AudioAnalysis/Peak` を選択
3. → 音楽が大きいほど明るく、静かなほど暗くなる

### 例 3: 高音でカラーシフト

高音域のレベル（High）をカラーや色相パラメータに接続すると、ハイハットやシンバルに反応して色が変化します。

## 感度の調整

オーディオ解析の感度は Audio Analysis Panel で調整できます。

| パラメータ | 説明 |
|------------|------|
| **Threshold** | トリガーが発火する閾値 |
| **Smoothing** | レベル信号のスムージング量 |
| **Gain** | 入力ゲイン |

### 調整のコツ

- トリガーが反応しすぎる → Threshold を上げる
- トリガーが反応しない → Threshold を下げる、または Gain を上げる
- レベル変化が激しすぎる → Smoothing を上げる

## トラブルシューティング

### 音声が入力されない

- Audio Device In で正しいデバイスが選択されているか確認
- 入力デバイスがシステムでミュートされていないか確認
- ループバックの場合、仮想オーディオデバイスが正しく設定されているか確認

### 反応が遅れる

- オーディオバッファサイズが大きすぎる可能性があります
- TouchDesigner のオーディオ設定でバッファサイズを小さくしてみてください

## 次のステップ

- **[シーケンサー](sequencer/)**: BPM 同期の自動変化と組み合わせる
- **[tox作成ガイド](../creating-tox/)**: オーディオ解析対応の tox を自作する
